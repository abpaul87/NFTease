<% if user_signed_in? %>
  <button id="back_button"><i class="fas fa-arrow-left"></i><%= link_to "Go Back", :back %></button>
<% end %>
<div class="background-color-edit" style="background-color:<%= @gallery.colors %>">
  <div id="preloader">
    <div id="preloader-header">
        <h1>Loading gallery...</h1>
    </div>
    <div id="preloader-center">
    </div>
  </div>

  <div class="public-gallery-container" style="display:none;" id="public-gallery-container">
    <div class="dash-main-content">
      <%= audio_check(@gallery) %>
      <div class="current-gallery">
        <h1><%=@gallery.name%></h1>
        <div class="public-cards">
          <% if !@nfts.nil? %>
            <% index = 0 %>
            <% @nfts.each do |nft| %>
              <section class="content-section" data-scroll>
              <%# <%= link_to gallery_nft_path(@gallery,nft) do %>
              <div data-toggle="modal" data-target="#nft-show-<%=nft.id%>">
                <div class="div figure">
                  <div class="public-card-nft">
                    <% if nft.image_url.match?(/.*mp4$/) %>
                      <video src='<%=nft.image_url%>', controls , loop, loading= <%= if index < 5 then 'eager' else 'auto' end %>></video>
                    <% elsif nft.image_url_small.match?(/.*mov$/) %>
                      <img src="https://res.cloudinary.com/jansommer/image/upload/v1638530952/nftease/no-image.png">
                    <% else %>
                      <img src='<%=nft.image_url%>' loading=<%=if index < 5 then 'eager' else 'auto' end%>>
                    <% end %>
                    <div class="public-card-nft-infos">
                      <div>
                        <h2 style="font-family:<%= @gallery.fonts %>;"><%=truncate(nft.token_name, length: 28)%></h2>
                        <p><%=truncate(nft.collection_name, :length =>50)%></p>
                      </div>
                    </div>
                  </div>
                </div>
              <div>

                  <!-- Modal -->
                  <div class="modal fade" id="nft-show-<%=nft.id%>" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                    </div>
                    <div class = "nft-modal-content" >
                      <div class="nft-modal-close">
                        <button type="button" class="notowhitebtn" data-dismiss="nft-show-<%=nft.id%>">
                          <i class="fas fa-times-circle"></i>
                        </button>
                      </div>

                      <div class="nft-modal-like">
                      <button class="button-like-img-nft">like <i class="fas fa-heart" style="color: #781f19;"><%  %></i></button>
                      </div>

                      <div class = "nft-modal_imagecontent">
                        <div class="nft-modal_image">
                          <%= image_tag nft.image_url %>
                        </div>
                      </div>
                      <div class = "nft-modal-left-content">
                        <div class = "nft-modal_textcontent">
                          <div class = "nft-modal_text">
                            <h2> <%= nft.token_name %></h2>
                            <h3 id="collectionName"> <%= nft.collection_name %></h3>
                            <p style="width: 85%; word-wrap: break-word;"> <%= truncate(nft.token_description, length: 520) %></p>
                            <h3  id="modal-content-h3"> Owned by: </h3>
                            <p> <%= nft.current_owner %></p>
                            <h3  id="modal-content-h3"> Created by: </h3>
                            <p> <%= nft.artist_name %></p>
                            <div id="buttons-OS-S-bottom">
                              <% if nft.forsale %>
                                <%= link_to nft.opensea_link, class: 'button', target:"_blank" do %>
                                  Buy now
                                <% end %>
                              <% end %>
                              <%= link_to nft.opensea_link, class: 'button', target:"_blank" do %>
                                OpenSea
                              <% end %>
                              <button class="button" data-url="<%= gallery_nft_url(@gallery, nft) %>" id="shareButtonShow">
                                Share
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <% index =+ 1%>
              </section>
            <%end%>
          <%end%>
        </div>
      </div>
    </div>
  </div>
</div>
